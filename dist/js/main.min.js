!(function () {
  window;
  const e = document.documentElement;
  if (
    (e.classList.remove("no-js"),
    e.classList.add("js"),
    document.body.classList.contains("has-animations"))
  ) {
    (window.sr = ScrollReveal()).reveal(".feature, .pricing-table-inner", {
      duration: 600,
      distance: "20px",
      easing: "cubic-bezier(0.5, -0.01, 0, 1.005)",
      origin: "bottom",
      interval: 100,
    }),
      e.classList.add("anime-ready"),
      anime
        .timeline({ targets: ".hero-figure-box-05" })
        .add({
          duration: 400,
          easing: "easeInOutExpo",
          scaleX: [0.05, 0.05],
          scaleY: [0, 1],
          perspective: "500px",
          delay: anime.random(0, 400),
        })
        .add({ duration: 400, easing: "easeInOutExpo", scaleX: 1 })
        .add({
          duration: 800,
          rotateY: "-15deg",
          rotateX: "8deg",
          rotateZ: "-1deg",
        }),
      anime
        .timeline({ targets: ".hero-figure-box-06, .hero-figure-box-07" })
        .add({
          duration: 400,
          easing: "easeInOutExpo",
          scaleX: [0.05, 0.05],
          scaleY: [0, 1],
          perspective: "500px",
          delay: anime.random(0, 400),
        })
        .add({ duration: 400, easing: "easeInOutExpo", scaleX: 1 })
        .add({ duration: 800, rotateZ: "20deg" }),
      anime({
        targets:
          ".hero-figure-box-01, .hero-figure-box-02, .hero-figure-box-03, .hero-figure-box-04, .hero-figure-box-08, .hero-figure-box-09, .hero-figure-box-10",
        duration: anime.random(600, 800),
        delay: anime.random(600, 800),
        rotate: [
          anime.random(-360, 360),
          function (e) {
            return e.getAttribute("data-rotation");
          },
        ],
        scale: [0.7, 1],
        opacity: [0, 1],
        easing: "easeInOutExpo",
      });
  }
})();

// FEATURES CAROUSEL
document.addEventListener("DOMContentLoaded", function () {
  const featureSlides = document.querySelectorAll(".feature-slide");
  let currentFeatureSlide = 0;

  function showFeatureSlide(index) {
    featureSlides[currentFeatureSlide].style.opacity = 0;
    featureSlides[currentFeatureSlide].classList.remove("active");

    currentFeatureSlide = (index + featureSlides.length) % featureSlides.length;

    featureSlides[currentFeatureSlide].style.opacity = 1;
    featureSlides[currentFeatureSlide].classList.add("active");
  }

  function nextFeatureSlide() {
    showFeatureSlide(currentFeatureSlide + 1);
  }

  // Show the first feature slide initially
  showFeatureSlide(0);

  // Auto-rotate features every 5 seconds
  setInterval(nextFeatureSlide, 5000);
});

// VIDEO CAROUSEL
document.addEventListener("DOMContentLoaded", function () {
  const videoSlider = document.querySelector(".demo-slider");
  const videoSlides = document.querySelectorAll(".demo-slide");
  const prevVideoButton = document.querySelector(".demo-prev");
  const nextVideoButton = document.querySelector(".demo-next");
  let currentVideoIndex = 0;

  function updateVideoSlider() {
    videoSlider.style.transform = `translateX(-${currentVideoIndex * 100}%)`;
    updateVideoPlayback();
  }

  function updateVideoPlayback() {
    videoSlides.forEach((slide, index) => {
      const video = slide.querySelector("video");
      if (index === currentVideoIndex) {
        video.play();
      } else {
        video.pause();
        video.currentTime = 0;
      }
    });
  }

  function nextVideoSlide() {
    currentVideoIndex = (currentVideoIndex + 1) % videoSlides.length;
    updateVideoSlider();
  }

  function prevVideoSlide() {
    currentVideoIndex =
      (currentVideoIndex - 1 + videoSlides.length) % videoSlides.length;
    updateVideoSlider();
  }

  nextVideoButton.addEventListener("click", nextVideoSlide);
  prevVideoButton.addEventListener("click", prevVideoSlide);

  // Initial setup for video slider
  updateVideoSlider();
});

// Tilt effect for features carousel
document.addEventListener("DOMContentLoaded", function () {
  const featuresCarousel = document.querySelector(".features-carousel");

  VanillaTilt.init(featuresCarousel, {
    max: 5, // maximum tilt rotation (degrees)
    speed: 400, // speed of the enter/exit transition
    glare: true, // whether to add glare effect
    "max-glare": 0.3, // maximum glare opacity
    scale: 1.05, // scale on hover
    gyroscope: true, // enable gyroscope on mobile devices
  });
});

// Hero copy animations
document.addEventListener("DOMContentLoaded", function () {
  const animatedElements = document.querySelectorAll(".hero-copy .animate-in");

  function animateHeroCopy() {
    animatedElements.forEach((el, index) => {
      setTimeout(() => {
        el.style.animation = `fadeInUp 0.6s ease-out ${index * 0.2}s forwards`;
      }, 100);
    });
  }

  // Trigger animation when the page loads
  animateHeroCopy();
});

// All Demos Page
document.addEventListener("DOMContentLoaded", function () {
  const demoCards = document.querySelectorAll(".demo-card");
  const videoPopup = document.getElementById("video-popup");
  const popupVideo = document.getElementById("popup-video");
  const closePopup = document.getElementById("close-popup");

  demoCards.forEach((card) => {
    card.addEventListener("click", () => {
      const videoUrl = card.dataset.videoUrl;
      popupVideo.src = videoUrl;
      videoPopup.style.display = "flex";
      popupVideo.play();
    });
  });

  closePopup.addEventListener("click", () => {
    videoPopup.style.display = "none";
    popupVideo.pause();
    popupVideo.currentTime = 0;
  });

  videoPopup.addEventListener("click", (e) => {
    if (e.target === videoPopup) {
      videoPopup.style.display = "none";
      popupVideo.pause();
      popupVideo.currentTime = 0;
    }
  });
});
